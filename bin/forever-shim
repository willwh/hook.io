#!/usr/bin/env node

var nconf = require('nconf');
nconf.argv = true;


var hookPath;

var path = require('path');

if (nconf.get("src")) {
  hookPath = path.resolve(nconf.get('src'));
}

if (nconf.get("hook-type")) {
  hookPath = 'hook.io-' + nconf.get('hook-type');
}

var Hook = require(hookPath);

var keys = Object.keys(Hook);

//
// Remark: Assume the first class exported extends from Hook
//

//
// TODO: Refactor this convention, it's a bit brittle
//
var hookClass = keys[0];
if (keys.length > 1) {
  hookClass = 'Hook';
}
var hook = new Hook[hookClass](nconf.system.store);

hook.start();
